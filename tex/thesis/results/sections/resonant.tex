%% resonant results
\section{Resonant}
We investigate the resonant regime, following ref \cite{Carmichael2015}, by computational solution of the master equation, mean-field methods, and monte-carlo simulations.

First, we extend the Jaynes-Cummings Model

\subsection{Driving \& Dissipation}
We add a coherent driving field to the Jaynes-Cummings hamiltonian. It is added coherently i.e.\ the system evolves unitarily with the drive, rather than the more general incoherent case (for example as \cite{Xu2014}), and the Hamiltonian reads:
\begin{align}
    \ham_{JC} &= \hbar \omega_d \cre \ann + \hbar \omega_q \atann \atcre +\hbar g (\cre \atann+ \hat{a} \atcre)\\
    & + \hbar \xi (\cre e^{i\omega_d t} + \ann e^{-i\omega_d t})
\end{align}
We also consider the effect of dissipation via two collapse operators, the spontaneous decay of the atom via $\atann$, with strength $\gamma$ and the decay of the cavity field via $\ann$, with strength $\kappa$. The total master equation reads:
\begin{equation}
  \dot{\rho} = \frac{1}{i\hbar}[\ham_{JC}, \rho] + \mathscr{L}_\kappa[\rho] + \mathscr{L}_\gamma[\rho]
\end{equation}
where $\mathscr{L}$ represents the Lindblad dissipator for each collapse parameter. 
We ignore pure dephasing.

We first move to a frame rotating at the drive frequency, giving a hamiltonian:
\begin{equation}
  \ham = \delta_{qd} \cre \ann + \delta_{cd} \atcre \atann + \hbar (\cre \atann + \ann \atcre) + \hbar (\ann + \cre)
\end{equation}
where the explicit time dependence has been removed.
\subsection{Photon Blockade}
With the cavity field on resonance ($\delta_{cd} = \delta_{cd} = \Delta$) with the two level transition, and for now neglecting the drive, the Jaynes Cummings Hamiltonian can be written.
\begin{equation}
  \ham_{JC} = \hbar \Delta (\cre \ann + \atann \atcre) +\hbar g (\cre \atann + \hat{a} \atcre)
\end{equation}
Diagonalising yields the \emph{dressed states}
\begin{align}
  \ket{E_{n, U}} & = \frac{1}{\sqrt{2}} (\kettens{n}{-}+\kettens{n-1}{+}) \\
  \ket{E_{n, L}} & = \frac{1}{\sqrt{2}} (\kettens{n}{-}-\kettens{n-1}{+})
\end{align}
in the tensor product of the field fock space and the atomic eigenspace spanned by the bare eigenstates $\ket{+}, \ket{-}$. These dressed eigenstates are superpositions of the bare states $\kettens{n}{-}$ and $\kettens{n-1}{+}$ and are balanced only in the resonant case. The eigenenergies are
\begin{align}
  E_{n, U} &= n \hbar \omega_0 + \sqrt{n} \hbar g \\
  E_{n, L} &= n \hbar \omega_0 - \sqrt{n} \hbar g
\end{align}
in which the Rabi splitting between the upper and lower dressed states is clear. In the absence of coupling to a dressing field $(g=0)$ the Jaynes-Cumming energies form a degenerate harmonic ladder; it is clear that the qubit coupling induces an anharmonicity via the characteristic $\sqrt{n}$ Rabi splitting.

We now consider the effect of an external drive tuned to the $\ket{G} \rightarrow \ket{E_{1, U/L}}$ transition\footnote{Drive frequencies at multiphoton resonances induce the same effect} (where $\ket{G}$ is the coincident dressed ground state $\ket{E_{0, -}} = \kettens{0}{-}$) with frequency $\omega_D = \hbar \omega_0 \pm \hbar g$.
The $\kettens{1}{U/L} \rightarrow \kettens{2}{U/L}$ step of the Jaynes Cummings ladder is now detuned from the drive by $E_{2, U/L} - E_{1, U/L} - \hbar \omega_D =  \mp(2-\sqrt{2}) \hbar g$. Thus for sufficiently large g and sufficiently small linewidth, the upper steps of the ladder are inaccessible, and the Jaynes Cumming system is opaque to further photon absorption until the photon is reemitted from the cavity through some loss process. This is the photon blockade effect.
\subsection{Near Resonant Drive}
Following \cite{Carmichael2015}, we treat the Jaynes-Cummings system with the cavity and qubit resonant, and demonstrate the existence of bimodalities in phase and amplitude.
The Hamiltonian is diagonalised on resonance via a canonical transformation \cite{Alsing1992}, with (quasi-)energies.
\begin{align}
  e_{n, +} &= + \sqrt{n} \hbar g {\left \{1 - {\left ({\frac{2\xi}{g}} \right )}^2 \right \}}^{\frac{3}{4}} \\
  e_{n, -} &= - \sqrt{n} \hbar g {\left \{1 - {\left ({\frac{2\xi}{g}} \right )}^2 \right \}}^{\frac{3}{4}}
\end{align}
A critical point in the spectrum appears at $\frac{2\xi}{g} = 1$, where the quasienergy splitting collapses to zero.
\subsection{Semiclassical}
We investigate the semiclassical equations for the system.
\begin{align}
  &\frac{d \alpha}{dt} = -(\kappa -i \Delta \omega) \alpha-ig \beta \label{eq:alpha}\\
  &\frac{d \beta}{dt} = i \Delta \omega \beta +ig \alpha \zeta \label{eq:beta}\\
  &\frac{d \zeta}{dt} = 2 i g(\alpha^* \beta -\alpha \beta^*)\label{eq:zeta}
\end{align}
and
\begin{equation}
  4|\beta|^2+\zeta^2 = 1 \label{eq:pseudospin}
\end{equation}
in the absence of spontaneous emission $\gamma=0$
\footnote{ Interestingly, setting $\gamma$ equal to zero at this point yields different asymptotic solutions to those for the system with $\gamma$ included and set to zero in the solution \cite{Alsing1990}},
A derivation can be found in the appendix.
\begin{figure}[!htb]
  \includegraphics[width=\linewidth]{sc_no_det.pdf}
  \caption{$\alpha$ and $\zeta$ as the drive strength $\xi$ moves up to through and beyond the critical point (a) $\zeta$ approaches zero with increasing drive strength (positive branch)\label{fig:zeta} (b) development of field phase bistability}\label{fig:alpha}
  \label{fig:sc_no_det}
\end{figure}
\subsubsection{Neoclassical Radiation Theory}
In the absence of drive and detuning and with the cavity field derivative set to zero
\begin{align}
  & 0 = -\kappa \alpha - ig \beta \\
  \implies & \alpha = \frac{ig}{\kappa} \beta
\end{align}
in \cref{eq:zeta}
\begin{equation}
  \frac{d \zeta}{dt} = -4 g^2 |\beta|^2
\end{equation}
and from \cref{eq:pseudospin}
\begin{align}
   |\beta|^2 &= (1-\zeta^2)/4 \\
\implies \frac{d \zeta}{dt} &= -\frac{g^2}{\kappa} (1-\zeta^2)
\end{align}
We recover the non exponential decay of neoclassical radiation theory
\subsubsection{Steady State}
\begin{figure*}[!htb]
    \includegraphics[width=\linewidth]{resonant.pdf}
    \caption{(a) Intracavity photon number in the semiclassical approximation (b) Intracavity photon number, fully quantum, with a field Hilbert space truncated at 85 excitations (c) Q functions with increasing drive on resonance}
    \label{resonant}
\end{figure*}
We now set all derivatives to zero, and consider the asymptotic solutions to the mean-field equations, which must satisfy:
\begin{align}
  -ig \beta -i \xi &= 0 \\
  ig\alpha \zeta &= 0
\end{align}
from which are obvious two branches of solutions $\rightarrow \zeta = 0$ or $\alpha = 0$. We take $\alpha = 0$ and from \cref{eq:alpha} and \cref{eq:pseudospin}
\begin{align}
  \beta &= -\frac{\xi}{g} \\
  \zeta &= \mp \sqrt{1 - {\left( \frac{2\xi}{g} \right)}^2}
\end{align}
Increasing drive through the critical point $\xi = \frac{g}{2}$ the difference under the square root becomes negative and the inversion $\zeta$ imaginary and unphysical. We take up the other branch $\zeta = 0$, and from \cref{eq:alpha}
\begin{align}
  \beta &= \pm \frac{\alpha}{2|\alpha|} \\
  \zeta &= 0
\end{align}
with $\alpha$ a solution to
\begin{equation}
  \alpha = -i \xi{\left ( \kappa \pm i \frac{g}{2|\alpha|} \right )}^{-1}
  \label{eq:alphacondnotdet}
\end{equation}
in \cref{fig:sc_no_det} the phase bistability above the critical point is obvious. The two $\beta$ solution branches start coincident in phase ($\pi$ and $-\pi$) at drive strengths just above critical and very quickly move to opposite sides of the Bloch sphere ($-\frac{\pi}{2}$ and $\frac{\pi}{2}$).

The phase of $\beta$ above the critical point follows the phase of $\alpha$, either aligned or antialigned. This spontaneous development of phase bistability Alsing and Carmichael call `Spontaneous Dressed State Polarisation' \cite{Alsing1990}. Referred to the fully quantum model, each of the two phases corresponds to a the system ascending different sets of rungs of the Jaynes Cummings ladder, either $\ket{E_{n, U}}$ or $\ket{E_{n, L}}$
\subsubsection{Non-zero detuning}
Solving \cref{eq:alpha}, \cref{eq:beta}, \cref{eq:zeta} in the steady state gives the following self consistency equation for $\alpha$
\begin{equation}
  \alpha = i \xi\frac{1}{\left[\kappa-i\left(\Delta \omega \mp \operatorname{sgn}(\Delta \omega) \frac{g^2}{\sqrt{\Delta \omega^2 +4g^2 |\alpha|^2}}\right)\right]}
\end{equation}
and for $\beta$ and $\zeta$
\begin{align}
  \beta& = \pm \operatorname{sgn}(\Delta \omega) \frac{g \alpha}{\sqrt{\Delta \omega^2 + 4 g^2 |\alpha|^2}}\\
  \zeta& = \mp \sqrt{1-4|\beta|^2}
\end{align}
for $\beta$ and $\zeta$, where $\operatorname{sgn}(\Delta \omega)$ is the sign of the detuning with $\operatorname{sgn}(0) = 1$.
The expression for $\alpha$ is a lorentzian, with dispersive sign dependent shift $ \operatorname{sgn}(\Delta\omega)\flatfrac{g^2}{\sqrt{\Delta\omega^2+4g^2\abs{\alpha}^2}}$, which diverges on resonance as alpha goes to zero. 
In the limit $\alpha \rightarrow \infty$ the system response returns to a rabi split ($\pm\flatfrac{g^2}{\Delta\omega}$) lorentzian.

The sides of the Lorentzians correspond to domains of coexistence between the near vacuum state and the high occupation state \cite{Carmichael2015}, and the phase transition between the two at this boundary is of first order. 
Here, photon blockade breaks down discontinuously.
The transition as the drive strength moves through the critical point is of second order, as indicated in the plots of the approach to steady state below, where critical slowing in the approach close to the critical point reveals its nature.
\begin{figure}[!htb]
  \includegraphics[width=\linewidth]{critical_slowing.pdf}
  \caption{Time dependent solutions to the master equation for different parameters. Note the slow asymptotic approach of the green line to the steady state}
  \label{critical_slowing}
\end{figure}
Numerical calculation of the Q function along the walls of the bilorentzian show a marked bimodality in amplitude. The development of this Q function bimodality is echoed in the Wigner representation. Moving through the critical point in the drive, the Q function bifurcates, this time in phase, where two coexistent gaussian peaks in phase space mark the phase bistability discussed above.
\subsection{Spontaneous Emission}
We now reintroduce the spontaneous emission parameter, both in the mean-field and the quantum case. 

Deexcitation fringes are also clear in \cref{resonant} where a spontaneous emission rate $ \gamma = \frac{\kappa}{2}$ connects the peaks of both of the bistabilities: in phase and in amplitude. Given the interpretation of such bimodal quasi-probability functions in the zero detuning case as as having a probability peak for the occupation of each ladder, it is clear that spontaneous emission serves to induce ladder-switching. It is this ladder switching that washes out the semiclassical bistability in the quantum regime.

We return to mean-field equations. The optical Bloch equations with spontaneous emission read (see \cref{sc_with_gamma})
\begin{align}
  \frac{d \alpha}{dt} &= -(\kappa - i \Delta \omega)\alpha - ig \beta - i\xi\label{eq:alphase}\\
  \frac{d \beta}{dt} &= -(\frac{\gamma}{2}-i\Delta\omega)\beta+ig\alpha\zeta \label{eq:betase}\\
  \frac{d\zeta}{dt} &= -\gamma (\zeta +1)+2ig(\alpha^*\beta-\alpha\beta^*) \label{eq:zetase}
\end{align}
In the steady state \cref{eq:alphase} becomes
\begin{align}
  \beta &= \frac{ig\alpha\zeta}{\frac{\gamma}{2}-i\Delta\omega}
\end{align}
from which in \cref{eq:zetase} in steady-state
\begin{align}
  0 &= -\gamma(\zeta+1)+2ig\frac{ig|\alpha|^2\zeta\frac{\gamma}{2}2}{\frac{\gamma^2}{4}+\Delta\omega^2} \\
  \implies \zeta &= \frac{1}{\frac{-2g^2|\alpha|^2}{\frac{\gamma^2}{4} +\Delta\omega^2}-1} \\
  &= \frac{1}{\frac{-2g^2|\alpha|^2 - \frac{\gamma^2}{4}-\Delta\omega^2}{\frac{\gamma^2}{4} +\Delta\omega^2}}
\end{align}
putting the above together yields
\begin{align}
  \beta &= \frac{ig\alpha\zeta}{\frac{\gamma}{2}-i\Delta\omega}\\
  &= \frac{ig\alpha}{\frac{(-2g^2|\alpha|^2-\frac{\gamma^2}{4}-\Delta\omega^2)(\frac{\gamma}{2}-i\Delta\omega)}{\frac{\gamma^2}{4}+\Delta\omega^2}}\\
  &= \frac{ig\alpha}{\frac{-2g^2|\alpha|^2-\frac{\gamma^2}{4}-\Delta\omega^2}{\frac{\gamma}{2}+i\Delta\omega^2}}\\
  &= \frac{ig\alpha(\frac{\gamma}{2}+i\Delta\omega)}{-2g^2|\alpha|^2-\frac{\gamma^2}{4}-\Delta\omega^2} \label{eq:betasolved}
\end{align}
\cref{eq:alphase} in the steady state with  \cref{eq:betasolved} becomes a condition for $\alpha$
\begin{align} % Here be weird bugs
  0&=-(\kappa-i\Delta\omega)\alpha-ig\beta-i\xi \\
  0&=-{(\kappa-i\Delta\omega)}\alpha-g\frac{ig(\frac{\gamma}{2}+i\Delta\omega)}{-2g^2|\alpha|^2-\frac{\gamma^2}{4}-\Delta\omega^2}\alpha-i\xi \\
\implies \alpha &= -i\xi \frac{1}{\kappa-i\Delta\omega+\frac{g^2(\frac{\gamma}{2}+i\Delta\omega)}{\frac{\gamma^2}{4}+{\Delta\omega}^2+2g{|\alpha|}^2}}\label{eq:alphadetdiss}
\end{align}

\Cref{eq:alphadetdiss} is the classical solution for the steady state of a saturable two level transition, with a saturation photon number ($I \propto |\alpha|^2 \approx n_{sat}$) of $n_{sat} = \frac{\gamma^2}{8g^2}$.  \\
Compare $\alpha$ derived with $\gamma$ present to without
\begin{widetext}
  \begin{align}
    \alpha(\kappa, \gamma) &= \flatfrac{-i\xi}{\left[ \kappa + \frac{g^2\gamma/2}{\gamma^2/4+\Delta\omega+2g\abs{\alpha}^2} - i\left( \Delta\omega+\frac{g^2\Delta\omega}{\gamma^2/4+\Delta\omega^2 + 2g\abs{\alpha}^2}\right)\right]}\\
            \alpha(\kappa) &= \flatfrac{-i\xi}{\left[\kappa-i\left(\Delta \omega - \frac{g^2}{\sqrt{\Delta \omega^2 +4g^2 |\alpha|^2}}\right)\right]}
  \end{align}
\end{widetext}
where the functional dependence on the collapse parameters has been shown.
Here, the lorentzians are broadened as well as shifted, by a factor $\flatfrac{g^2\gamma/2}{(\gamma^2/4+\Delta\omega + 2g\abs{\alpha}^2)}$
\subsubsection{Difference between limits}
Setting $\gamma$ and $\Delta\omega$ to zero, the condition becomes
\begin{equation}
  \alpha = -i\xi\frac{1}{\kappa}
\end{equation}
which is notably not the same as \cref{eq:alphacondnotdet}.\\

The presence of $\gamma$ in the Maxwell-Bloch Equations changes the asymptotic solutions, even if $\gamma$ is set to zero in these solutions.
The conservation law $4|\beta|^2 +\zeta^2 = 1$ is broken by the qubit relaxation parameter $\gamma$.
The solutions in the case that the limit is taken after steady state requirement is imposed are those of absorptive optical bistability.
In the limit $\frac{\gamma}{\kappa} \rightarrow 0$ the rate at which these steady states are approached becomes vanishingly small
 \cite{Alsing1990}.
